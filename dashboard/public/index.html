<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload</title>
</head>
<body>
  <form name="newItem" action="/upload" onsubmit="createListing(); return false;" method="post" enctype="multipart/form-data">
    <h4>New Listing</h4>
    
    <div class="form-group">
      <label>Title</label>
      <input type="text" placeholder="Title of your listing" class="form-control" name="title" value="" maxlength="100" autofocus="" required>
    </div>

    <div class="form-group">
      <label>Description</label>
      <input type="textarea" placeholder="Share details about the item you're selling..." class="form-control" name="description" value="" autofocus="" required>
    </div>

    <div class="form-group">
      <label>Price</label>
      <input type="number" placeholder="0" class="form-control" name="price" value="" maxlength="100" autofocus="" required>
    </div>

     <div class="form-group">
      <label>Image</label>
      <input type="file" class="form-control" name="image" autofocus="" required>
    </div>

    <div class="btn-wrapper">
      <button type="submit" class="btn btn-success" name="submit">Post Item</button>
    </div>
  </form>

  <script src="https://cdn.wedeploy.com/api/4.0.2/wedeploy.js"></script>
  <script>
    var auth = WeDeploy.auth('auth-forsale.wedeploy.io');
    var data = WeDeploy.data('data-forsale.wedeploy.io');
    
    if (auth.currentUser == null) {
      location.href = 'login.html';
    }

    function createListing() {
      data.create('listings', {
        'uid': auth.currentUser.id,
        'title': newItem.title.value,
        'description': newItem.description.value,
        'price': newItem.price.value,
        'image': newItem.file.name
      })
    }

    function signOut() {
        auth.signOut()
        .then(function() {
          location.href = 'login.html';
        });
    }
  </script>
  </body>
</body>
</html>